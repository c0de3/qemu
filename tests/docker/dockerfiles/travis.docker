FROM travisci/ci-sardonyx:packer-1546978056-2c98a19
ENV CI=true \
    TRAVIS=true \
    CONTINUOUS_INTEGRATION=true \
    DEBIAN_FRONTEND=noninteractive \
    LANG=en_US.UTF-8 \
    LC_ALL=en_US.UTF-8 \
    TRAVIS_OS_NAME=linux
RUN sed -i "s/# deb-src/deb-src/" /etc/apt/sources.list
RUN apt-get update
RUN apt-get -y build-dep qemu
RUN apt-get -y install \
    device-tree-compiler \
    dh-autoreconf \
    gcovr \
    gdb strace \
    lsof \
    net-tools \
    python2.7 \
    python3-pip \
    python3.5-venv \
    python-yaml
# Travis tools require PhantomJS / Neo4j / Maven accessible
# in their PATH (QEMU build won't access them).
ENV PATH /usr/local/phantomjs/bin:/usr/local/phantomjs:/usr/local/neo4j-3.2.7/bin:/usr/local/maven-3.5.2/bin:/usr/local/cmake-3.9.2/bin:/usr/local/clang-5.0.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
ENV FEATURES clang pyyaml
USER travis
