QA output created by 257
== creating a test image ==
Formatting 'TEST_DIR/t.IMGFMT', fmt=IMGFMT size=33554432

== test that key 0 opens the image ==
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)

== adding a password to slot 1 ==
== adding a password to slot 3 ==
== adding a password to slot 2 ==

== all secrets should work ==
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)

== erase slot 0 and try it ==
qemu-io: can't open: Invalid password, cannot unlock any keyslot

== erase slot 2 and try it ==
qemu-io: can't open: Invalid password, cannot unlock any keyslot

== filling  4 slots with secret 2 ==

== adding secret 0 ==

== adding secret 3 (last slot) ==

== trying to add another slot (should fail) ==
qemu-img: Can't add a keyslot - all key slots are in use

== all secrets should work again ==
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)

== erase all keys of secret 2==
== erase all keys of secret 1==
== erase all keys of secret 0==
== erase all keys of secret 3, except a remaining key ==

== only secret3 should work now  ==
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)

== add secret0  ==
== erase secret3 ==

== only secret0 should work now  ==
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot

== replace secret0 with secret1 (should fail)  ==
qemu-img: Can't update an active key slot 0

== replace secret0 with secret1 with force (should work)  ==

== only secret1 should work now  ==
qemu-io: can't open: Invalid password, cannot unlock any keyslot
read 4096/4096 bytes at offset 0
4 KiB, X ops; XX:XX:XX.X (XXX YYY/sec and XXX ops/sec)
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot

== erase last secret (should fail)  ==
qemu-img: Only one slot active - can't erase
qemu-img: Only one slot active - can't erase
== erase non existing secrets (should fail)  ==
qemu-img: No secret with id 'sec5'
qemu-img: Didn't erase a keyslot, because no keyslots match the given password

== erase last secret with force by slot (should work)  ==

== we have no secrets now, data is lost forever ==
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
qemu-io: can't open: Invalid password, cannot unlock any keyslot
*** done
