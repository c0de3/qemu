\input texinfo
@setfilename qemu-qmp-ref.info

@exampleindent 0
@paragraphindent 0

@settitle QEMU QMP Reference Manual

@copying
This is the QEMU QMP reference manual.

Copyright @copyright{} 2016 The QEMU Project developers
@end copying

@ifinfo
@dircategory QEMU
@direntry
* QEMU-QMP-Ref: (qemu-qmp-ref). QEMU QMP Reference Manual
@end direntry
@end ifinfo

@titlepage
@title QMP Reference Manual
@subtitle QEMU version @value{VERSION}
@page
@vskip 0pt plus 1filll
@insertcopying
@end titlepage

@contents

@ifnottex
@node Top
@top QEMU QMP reference
@end ifnottex

@menu
* Introduction::
* API Reference::
* Commands and Events Index::
* Data Types Index::
@end menu

@node Introduction
@chapter Introduction

The QEMU Machine Protocol (@acronym{QMP}) allows applications to
operate a QEMU instance.

QMP is @uref{http://www.json.org, JSON} based and features the
following:

@itemize @bullet
@item
Lightweight, plain-text, easy to parse data format
@item
Asynchronous messages support (ie. events)
@item
Capabilities Negotiation
@item
Introspection
@end itemize

For detailed information on QEMU Machine Protocol, the specification
is in @file{qmp-spec.txt}.

@section Usage

You can use the @option{-qmp} option to enable QMP. For example, the
following makes QMP available on localhost port 4444:

@example
$ qemu [...] -qmp tcp:localhost:4444,server,nowait
@end example

However, for more flexibility and to make use of more options, the
@option{-mon} command-line option should be used. For instance, the
following example creates one HMP instance (human monitor) on stdio
and one QMP instance on localhost port 4444:

@example
$ qemu [...] -chardev socket,id=mon1,host=localhost,port=4444,server,nowait \
             -mon chardev=mon1,mode=control,pretty=on
@end example

Please refer to QEMU's manpage for more information.

@section Simple testing

To manually test QMP one can connect with telnet and issue commands by
hand:

@example
$ telnet localhost 4444
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
@{
    "QMP": @{
        "version": @{
            "qemu": @{
                "micro": 50,
                "minor": 6,
                "major": 1
            @},
            "package": ""
        @},
        "capabilities": [
        ]
    @}
@}

@{ "execute": "qmp_capabilities" @}
@{
    "return": @{
    @}
@}

@{ "execute": "query-status" @}
@{
    "return": @{
        "status": "prelaunch",
        "singlestep": false,
        "running": false
    @}
@}
@end example

@section Wiki

Please refer to the @uref{http://wiki.qemu-project.org/QMP, QMP QEMU
 wiki page} for more details on QMP.

@node API Reference
@chapter API Reference

@c for texi2pod:
@c man begin DESCRIPTION

@include qemu-qapi.texi

@c man end

@c man begin SEEALSO
The HTML documentation of QEMU for more precise information.
@c man end

@node Commands and Events Index
@unnumbered Commands and Events Index
@printindex fn

@node Data Types Index
@unnumbered Data Types Index
@printindex tp

@bye
